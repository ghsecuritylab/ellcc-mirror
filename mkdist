#! /bin/sh
if [ $# -ne 1 ] ; then
    echo "$0: <target-os>"
    exit 1
fi
name=ellcc-$1-`date +%Y-%b-%d-%H-%M-%S`.tgz

if [ -e bin-$1 ] ; then
  # The non-native bin directory exists.
  mv bin bin.save
  ln -s bin-$1 bin
fi
make -C baremetal clean
cd ..; tar cvfpz ellcc/$name -T ellcc/ellcc.files -T ellcc/ellcc.bin.files; cd -
if [ -e bin-$1 ] ; then
  rm bin
  mv bin.save bin
fi
echo created $name
